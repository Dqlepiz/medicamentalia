(function(){var t=function(t,n){return function(){return t.apply(n,arguments)}};window.BaseGraph=function(){function n(n,e){return this.onResize=t(this.onResize,this),this.setupMarkerLabel=t(this.setupMarkerLabel,this),this.setupMarkerLine=t(this.setupMarkerLine,this),this.id=n,this.options=$.extend(!0,i,e),this.$el=$("#"+this.id),this.getDimensions(),this.setSVG(),this.setScales(),this.markers=[],this}var e,i;return i={margin:{top:0,right:0,bottom:20,left:0},aspectRatio:.5625,label:!1,key:{id:"key",x:"key",y:"value"}},e={value:null,label:"",orientation:"horizontal",align:"right"},n.prototype.setSVG=function(){return this.svg=d3.select("#"+this.id).append("svg").attr("width",this.containerWidth).attr("height",this.containerHeight),this.container=this.svg.append("g").attr("transform","translate("+this.options.margin.left+","+this.options.margin.top+")")},n.prototype.loadData=function(t){return d3.csv(t,function(t){return function(n,e){return t.setData(e)}}(this)),this},n.prototype.setData=function(t){return this.data=this.dataParser(t),this.drawScales(),this.drawMarkers(),this.drawGraph(),this},n.prototype.dataParser=function(t){return t},n.prototype.setGraph=function(){return this},n.prototype.setScales=function(){return this},n.prototype.drawScales=function(){return this.x.domain(this.getScaleXDomain()),this.y.domain(this.getScaleYDomain()),this.xAxis&&this.container.append("g").attr("class","x axis").attr("transform","translate(0,"+this.height+")").call(this.xAxis),this.yAxis&&this.container.append("g").attr("class","y axis").attr("transform","translate("+this.width+" ,0)").call(this.yAxis),this},n.prototype.getScaleXRange=function(){return[0,this.width]},n.prototype.getScaleYRange=function(){return[this.height,0]},n.prototype.getScaleXDomain=function(){return[]},n.prototype.getScaleYDomain=function(){return[]},n.prototype.addMarker=function(t){return this.markers.push($.extend({},e,t)),this},n.prototype.drawMarkers=function(){return this.container.selectAll(".marker").data(this.markers).enter().append("line").attr("class","marker").call(this.setupMarkerLine),this.container.selectAll(".marker-label").data(this.markers).enter().append("text").attr("class","marker-label").attr("text-anchor",function(t){return"vertical"===t.orientation?"middle":"right"===t.align?"end":"start"}).text(function(t){return t.label}).call(this.setupMarkerLabel)},n.prototype.setupMarkerLine=function(t){return t.attr("x1",function(t){return function(n){return"horizontal"===n.orientation?0:t.x(n.value)}}(this)).attr("y1",function(t){return function(n){return"horizontal"===n.orientation?t.y(n.value):0}}(this)).attr("x2",function(t){return function(n){return"horizontal"===n.orientation?t.width:t.x(n.value)}}(this)).attr("y2",function(t){return function(n){return"horizontal"===n.orientation?t.y(n.value):t.height}}(this))},n.prototype.setupMarkerLabel=function(t){return t.attr("x",function(t){return function(n){return"horizontal"===n.orientation?"right"===n.align?t.width:0:t.x(n.value)}}(this)).attr("y",function(t){return function(n){return"horizontal"===n.orientation?t.y(n.value):t.height}}(this))},n.prototype.onResize=function(){return this.getDimensions(),this.updateGraphDimensions(),this},n.prototype.getDimensions=function(){return this.$el&&(this.containerWidth=this.$el.width(),this.containerHeight=this.containerWidth*this.options.aspectRatio,this.width=this.containerWidth-this.options.margin.left-this.options.margin.right,this.height=this.containerHeight-this.options.margin.top-this.options.margin.bottom),this},n.prototype.updateGraphDimensions=function(){return this.svg.attr("width",this.containerWidth).attr("height",this.containerHeight),this.x.range(this.getScaleXRange()),this.y.range(this.getScaleYRange()),this.xAxis&&this.container.selectAll(".x.axis").attr("transform","translate(0,"+this.height+")").call(this.xAxis),this.yAxis&&this.container.selectAll(".y.axis").attr("transform","translate("+this.width+" ,0)").call(this.yAxis),this.container.select(".marker").call(this.setupMarkerLine),this.container.select(".marker-label").call(this.setupMarkerLabel),this},n}()}).call(this),function(){var t=function(t,n){return function(){return t.apply(n,arguments)}},n=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t},e={}.hasOwnProperty;window.BarGraph=function(e){function i(n,e){return this.setBarLabelYDimensions=t(this.setBarLabelYDimensions,this),this.setBarLabelXDimensions=t(this.setBarLabelXDimensions,this),this.setBarDimensions=t(this.setBarDimensions,this),this.getScaleYDomain=t(this.getScaleYDomain,this),this.getScaleXDomain=t(this.getScaleXDomain,this),i.__super__.constructor.call(this,n,e),this}return n(i,e),i.prototype.dataParser=function(t){return t.forEach(function(t){return function(t){return t.value=+t.value}}(this)),t},i.prototype.setScales=function(){return this.x=d3.scaleBand().range(this.getScaleXRange()).paddingInner(.1).paddingOuter(0),this.y=d3.scaleLinear().range(this.getScaleYRange()),this},i.prototype.getScaleXDomain=function(){return this.data.map(function(t){return function(n){return n[t.options.key.x]}}(this))},i.prototype.getScaleYDomain=function(){return[0,d3.max(this.data,function(t){return function(n){return n[t.options.key.y]}}(this))]},i.prototype.drawGraph=function(){return this.container.selectAll(".bar").data(this.data).enter().append("rect").attr("class",function(t){return t.active?"bar active":"bar"}).attr("id",function(t){return function(n){return n[t.options.key.id]}}(this)).call(this.setBarDimensions),this.options.label&&(this.container.selectAll(".bar-label-x").data(this.data).enter().append("text").attr("class",function(t){return t.active?"bar-label-x active":"bar-label-x"}).attr("id",function(t){return function(n){return"bar-label-x-"+n[t.options.key.id]}}(this)).attr("dy","1.5em").attr("text-anchor","middle").text(function(t){return function(n){return n[t.options.key.x]}}(this)).call(this.setBarLabelXDimensions),this.container.selectAll(".bar-label-y").data(this.data).enter().append("text").attr("class",function(t){return t.active?"bar-label-y active":"bar-label-y"}).attr("id",function(t){return function(n){return"bar-label-y-"+n[t.options.key.id]}}(this)).attr("dy","-0.5em").attr("text-anchor","middle").text(function(t){return function(n){return n[t.options.key.y]}}(this)).call(this.setBarLabelYDimensions)),this},i.prototype.updateGraphDimensions=function(){return i.__super__.updateGraphDimensions.call(this),this.container.selectAll(".bar").call(this.setBarDimensions),this.container.selectAll(".bar-label-x").call(this.setBarLabelXDimensions),this.container.selectAll(".bar-label-y").call(this.setBarLabelYDimensions),this},i.prototype.setBarDimensions=function(t){return t.attr("x",function(t){return function(n){return t.x(n[t.options.key.x])}}(this)).attr("y",function(t){return function(n){return t.y(n[t.options.key.y])}}(this)).attr("height",function(t){return function(n){return t.height-t.y(n[t.options.key.y])}}(this)).attr("width",this.x.bandwidth())},i.prototype.setBarLabelXDimensions=function(t){return t.attr("x",function(t){return function(n){return t.x(n[t.options.key.x])+.5*t.x.bandwidth()}}(this)).attr("y",function(t){return function(n){return t.height}}(this))},i.prototype.setBarLabelYDimensions=function(t){return t.attr("x",function(t){return function(n){return t.x(n[t.options.key.x])+.5*t.x.bandwidth()}}(this)).attr("y",function(t){return function(n){return t.y(n[t.options.key.y])}}(this))},i}(window.BaseGraph)}.call(this),function(){!function(t){var n,e,i,r;if(i=t("body").data("lang"),n=t("body").data("baseurl"),e=function(t,n,e){var i;return i=t.filter(function(t){return t.code2===n}),i.length?i[0]["name_"+e]:void 0},t(".bar-graph").length>0)return r={"antibiotics-graph":{value:36,label:"es"===t("body").data("lang")?"Media EU28":"EU28 Average"},"antibiotics-animals-graph":{value:107.8,label:"es"===t("body").data("lang")?"Media":"Average"}},d3.queue().defer(d3.csv,n+"/assets/data/antibiotics.csv").defer(d3.csv,n+"/assets/data/antibiotics-animals.csv").defer(d3.csv,n+"/assets/data/countries.csv").await(function(n,a,s,o){return a.forEach(function(t){return t.name=e(o,t.label,i)}),s.forEach(function(t){return t.name=e(o,t.label,i)}),t(".bar-graph").each(function(){var n,e;return e=t(this).attr("id"),n=new window.BarGraph(e,{aspectRatio:.4,label:!0,key:{id:"label",x:"name"}}),n.addMarker(r[e]).setData("antibiotics-graph"===e?a:s),t(window).resize(n.onResize)})})}(jQuery)}.call(this);